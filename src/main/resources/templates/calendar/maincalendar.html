<!DOCTYPE html>
<html lang="kr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>이번 달 달력</title>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet"/>
    <style>
        body {
            font-family: Arial, sans-serif;
            transition: background-color 0.3s, color 0.3s;
        }
        .navbar {
            transition: background-color 0.3s, color 0.3s;
        }
        .calendar {
            max-width: 900px;
            margin: 0 auto;
            border: 1px solid #ddd;
            border-radius: 8px;
            overflow: hidden;
            transition: border-color 0.3s;
        }
        .calendar-header {
            display: flex;
            justify-content: space-between;
            padding: 10px;
            border-bottom: 1px solid #ddd;
            transition: background-color 0.3s, color 0.3s;
        }
        .calendar-header h2 {
            margin: 0;
        }
        .calendar-header button {
            border: none;
            background-color: #007bff;
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .calendar-header button:disabled {
            background-color: #ccc;
        }
        .calendar-body {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            grid-gap: 1px;
        }
        .calendar-day {
            padding: 10px;
            text-align: right;
            border: 1px solid #ddd;
            box-sizing: border-box;
            cursor: pointer;
            position: relative;
            aspect-ratio: 1; /* 날짜 칸 정사각형 유지 */
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        .calendar-day-header {
            font-weight: bold;
            text-align: center;
            padding: 5px 0;
            aspect-ratio: 3; /* 요일 칸의 비율 조정 */
        }
        .calendar-day:hover {
            background-color: #e7f1ff;
        }
        .calendar-day.selected {
            background-color: #007bff;
            color: white;
        }
        .calendar-day.today {
            background-color: #ffffe0; /* 옅은 노란색 배경 */
        }
        .calendar-day .event-count {
            position: absolute;
            bottom: 5px;
            right: 5px;
            font-size: 0.75em;
            color: #007bff;
        }
        .nav-tabs .nav-link {
            color: #007bff;
        }
        .nav-tabs .nav-link.active {
            background-color: #007bff;
            color: white;
        }
        /* 다크 모드 스타일 */
        .dark-mode {
            background-color: #121212;
            color: #e0e0e0;
        }
        .dark-mode .navbar {
            background-color: #333;
            color: #e0e0e0;
        }
        .dark-mode .calendar {
            border-color: #444;
        }
        .dark-mode .calendar-header {
            background-color: #333;
            color: #e0e0e0;
        }
        .dark-mode .calendar-header button {
            background-color: #555;
        }
        .dark-mode .calendar-day {
            background-color: #1e1e1e;
            color: #e0e0e0;
            border-color: #333;
        }
        .dark-mode .calendar-day:hover {
            background-color: #333;
        }
        .dark-mode .calendar-day.selected {
            background-color: #007bff;
            color: #fff;
        }
        .dark-mode .calendar-day.today {
            background-color: #2a2a2a;
        }
        .dark-mode .calendar-day .event-count {
            color: #007bff;
        }
        .dark-mode .nav-tabs .nav-link {
            color: #e0e0e0;
        }
        .dark-mode .nav-tabs .nav-link.active {
            background-color: #007bff;
            color: #fff;
        }
    </style>
</head>
<body>
<nav class="navbar navbar-light">
    <div class="ml-auto d-flex">
        <a class="navbar-brand mr-3" href="#">님의 캘린더</a>
        <a class="nav-link" href="#">로그아웃</a>
        <button id="toggleModeButton" class="btn btn-secondary ml-2">모드 전환</button>
    </div>
</nav>

<div class="calendar">
    <div class="calendar-header">
        <button id="prevMonth">이전</button>
        <h2 id="monthYear"></h2>
        <button id="nextMonth">다음</button>
    </div>
    <div class="calendar-body" id="calendarBody">
        <!-- 달력의 날짜들이 여기에 표시됩니다 -->
    </div>
</div>

<!-- 일정 및 루틴 추가 모달 -->
<div class="modal fade" id="routineModal" tabindex="-1" role="dialog" aria-labelledby="routineModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="routineModalLabel">일정/루틴 추가</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <ul class="nav nav-tabs" id="myTab" role="tablist">
                    <li class="nav-item">
                        <a class="nav-link active" id="schedule-tab" data-toggle="tab" href="#schedule" role="tab" aria-controls="schedule" aria-selected="true">일정</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" id="routine-tab" data-toggle="tab" href="#routine" role="tab" aria-controls="routine" aria-selected="false">루틴</a>
                    </li>
                </ul>
                <div class="tab-content" id="myTabContent">
                    <!-- 일정 추가 탭 -->
                    <div class="tab-pane fade show active" id="schedule" role="tabpanel" aria-labelledby="schedule-tab">
                        <form id="scheduleForm">
                            <div class="form-group">
                                <label for="scheduleTitle">일정 제목</label>
                                <input type="text" class="form-control" id="scheduleTitle" required>
                            </div>
                            <div class="form-group form-check">
                                <input type="checkbox" class="form-check-input" id="allDay">
                                <label class="form-check-label" for="allDay">하루 종일</label>
                            </div>
                            <div class="form-group">
                                <label for="scheduleStartDate">시작 날짜</label>
                                <input type="date" class="form-control" id="scheduleStartDate" required>
                            </div>
                            <div class="form-group">
                                <label for="scheduleEndDate">종료 날짜</label>
                                <input type="date" class="form-control" id="scheduleEndDate" required>
                            </div>
                            <div class="form-group">
                                <label for="scheduleDetails">일정 내용</label>
                                <textarea class="form-control" id="scheduleDetails" rows="3"></textarea>
                            </div>
                            <div class="form-group">
                                <label for="scheduleParticipants">참석자</label>
                                <input type="text" class="form-control" id="scheduleParticipants">
                            </div>
                            <div class="form-group">
                                <label for="scheduleLocation">장소</label>
                                <input type="text" class="form-control" id="scheduleLocation">
                            </div>
                        </form>
                    </div>
                    <!-- 루틴 추가 탭 -->
                    <div class="tab-pane fade" id="routine" role="tabpanel" aria-labelledby="routine-tab">
                        <form id="routineForm">
                            <div class="form-group">
                                <label for="routineTitle">루틴 제목</label>
                                <input type="text" class="form-control" id="routineTitle" required>
                            </div>
                            <div class="form-group">
                                <label for="routineFrequency">반복 빈도</label>
                                <select class="form-control" id="routineFrequency">
                                    <option>매일</option>
                                    <option>매주</option>
                                    <option>매월</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="routineTime">시간</label>
                                <input type="time" class="form-control" id="routineTime" required>
                            </div>
                            <div class="form-group">
                                <label for="routineDetails">루틴 내용</label>
                                <textarea class="form-control" id="routineDetails" rows="3"></textarea>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">취소</button>
                <button type="button" class="btn btn-primary" id="saveRoutineButton">저장</button>
            </div>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        let currentDate = new Date();
        const calendarBody = document.getElementById('calendarBody');
        const monthYear = document.getElementById('monthYear');

        function generateCalendar(date) {
            calendarBody.innerHTML = '';
            const year = date.getFullYear();
            const month = date.getMonth();
            const firstDayOfMonth = new Date(year, month, 1).getDay();
            const lastDateOfMonth = new Date(year, month + 1, 0).getDate();

            monthYear.textContent = `${year}년 ${month + 1}월`;

            // 요일 헤더 추가
            const weekdays = ['일', '월', '화', '수', '목', '금', '토'];
            weekdays.forEach(weekday => {
                const dayHeader = document.createElement('div');
                dayHeader.className = 'calendar-day-header';
                dayHeader.textContent = weekday;
                calendarBody.appendChild(dayHeader);
            });

            // 빈 칸 채우기
            for (let i = 0; i < firstDayOfMonth; i++) {
                const emptyCell = document.createElement('div');
                emptyCell.className = 'calendar-day';
                calendarBody.appendChild(emptyCell);
            }

            // 날짜 채우기
            for (let day = 1; day <= lastDateOfMonth; day++) {
                const dateCell = document.createElement('div');
                dateCell.className = 'calendar-day';
                dateCell.textContent = day;
                dateCell.dataset.date = `${year}-${month + 1}-${day}`;

                // 오늘 날짜 강조
                if (new Date().toDateString() === new Date(year, month, day).toDateString()) {
                    dateCell.classList.add('today');
                }

                // 날짜 선택 시 모달 열기
                dateCell.addEventListener('click', function () {
                    document.getElementById('routineModalLabel').textContent = `${year}년 ${month + 1}월 ${day}일 일정/루틴 추가`;
                    document.getElementById('scheduleStartDate').value = this.dataset.date;
                    document.getElementById('scheduleEndDate').value = this.dataset.date;
                    $('#routineModal').modal('show');
                });

                calendarBody.appendChild(dateCell);
            }
        }

        function handleMonthChange(direction) {
            currentDate.setMonth(currentDate.getMonth() + direction);
            generateCalendar(currentDate);
        }

        document.getElementById('prevMonth').addEventListener('click', () => handleMonthChange(-1));
        document.getElementById('nextMonth').addEventListener('click', () => handleMonthChange(1));

        // 모드 전환
        const toggleModeButton = document.getElementById('toggleModeButton');
        toggleModeButton.addEventListener('click', function () {
            document.body.classList.toggle('dark-mode');
        });

        // 모달 초기화
        $('#routineModal').on('hidden.bs.modal', function () {
            document.getElementById('scheduleForm').reset();
            document.getElementById('routineForm').reset();
        });

        // 저장 버튼 클릭
        document.getElementById('saveRoutineButton').addEventListener('click', function () {
            const activeTab = document.querySelector('.tab-pane.active');
            if (activeTab.id === 'schedule') {
                const title = document.getElementById('scheduleTitle').value;
                const startDate = document.getElementById('scheduleStartDate').value;
                const endDate = document.getElementById('scheduleEndDate').value;
                if (!title || !startDate || !endDate) {
                    alert('모든 필수 정보를 입력해주세요.');
                    return;
                }
                // 일정 저장 로직 추가
                alert('일정이 저장되었습니다.');
            } else if (activeTab.id === 'routine') {
                const title = document.getElementById('routineTitle').value;
                const time = document.getElementById('routineTime').value;
                if (!title || !time) {
                    alert('모든 필수 정보를 입력해주세요.');
                    return;
                }
                // 루틴 저장 로직 추가
                alert('루틴이 저장되었습니다.');
            }
            $('#routineModal').modal('hide');
        });

        // 초기 캘린더 생성
        generateCalendar(currentDate);
    });
</script>
<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.bundle.min.js"></script>
</body>
</html>
